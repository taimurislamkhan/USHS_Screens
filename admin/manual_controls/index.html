<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./vars.css">
  <link rel="stylesheet" href="./style.css">
  
  
  <style>
   a,
   button,
   input,
   select,
   h1,
   h2,
   h3,
   h4,
   h5,
   * {
       box-sizing: border-box;
       margin: 0;
       padding: 0;
       border: none;
       text-decoration: none;
       background: none;
   
       -webkit-font-smoothing: antialiased;
   }
   
   menu, ol, ul {
       list-style-type: none;
       margin: 0;
       padding: 0;
   }
   </style>
  <title>Document</title>
</head>
<body>
  <div class="admin-manual-controls">
    <div class="frame-160">
      <div class="home" onclick="navigateToPage('../../index.html')">
        <div class="rectangle-4"></div>
        <div class="frame">
          <img class="svg-repo-icon-carrier" src="svg-repo-icon-carrier0.svg" />
        </div>
      </div>
      <div class="frame-184">
        <div class="button-control" onclick="navigateToPage('../../settings/work_position/index.html')">
          <div class="rectangle-42"></div>
          <div class="frame2">
            <img
              class="svg-repo-icon-carrier2"
              src="svg-repo-icon-carrier1.svg"
            />
          </div>
        </div>
        <div class="button-settings">
          <div class="frame">
            <img
              class="svg-repo-icon-carrier3"
              src="svg-repo-icon-carrier2.svg"
            />
          </div>
        </div>
      </div>
    </div>
    <div class="frame-42">
      <div class="frame-92">
        <div class="platen">Platen</div>
        <div class="frame-193">
          <div class="frame-5">
            <div class="manual-platen-distance">0 mm</div>
          </div>
          <div class="frame-183">
            <div class="manual-platen-up">
              <img
                class="svg-repo-icon-carrier4"
                src="svg-repo-icon-carrier3.svg"
              />
              <div class="rectangle-5"></div>
            </div>
            <div class="manual-platen-down">
              <div class="rectangle-43"></div>
              <img
                class="svg-repo-icon-carrier5"
                src="svg-repo-icon-carrier4.svg"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="frame-93">
        <div class="heating">Heating</div>
        <div class="cooling">Cooling</div>
        <div class="frame-200">
          <div class="frame-198">
            <div class="manual-tip-heat-1">
              <div class="_1">1</div>
            </div>
            <div class="manual-tip-heat-2">
              <div class="_2">2</div>
            </div>
            <div class="manual-tip-heat-3">
              <div class="_3">3</div>
            </div>
            <div class="manual-tip-heat-4">
              <div class="_4">4</div>
            </div>
          </div>
          <div class="frame-199">
            <div class="manual-tip-heat-5">
              <div class="_5">5</div>
            </div>
            <div class="manual-tip-heat-6">
              <div class="_6">6</div>
            </div>
            <div class="manual-tip-heat-7">
              <div class="_7">7</div>
            </div>
            <div class="manual-tip-heat-8">
              <div class="_8">8</div>
            </div>
          </div>
        </div>
        <div class="manual-cooling">
          <div class="on">ON</div>
        </div>
      </div>
    </div>
    <div class="frame-47">
      <div class="frame-45">
        <div class="manual-controls">Manual Controls</div>
      </div>
      <div class="monitor" onclick="navigateToPage('../monitor/index.html')">
        <div class="monitor2">Monitor</div>
      </div>
    </div>
    <img class="image-3" src="image-30.png" />
  </div>
  
  <script>
    function navigateToPage(relativePath) {
      window.location.href = relativePath;
    }
    
    // Add click styling to navigation buttons
    const style = document.createElement('style');
    style.textContent = `
      .home, .button-control, .monitor {
        cursor: pointer;
        transition: opacity 0.2s ease;
      }
      .home:hover, .button-control:hover, .monitor:hover {
        opacity: 0.8;
      }
      /* Press feedback for black buttons */
      .pressed-blue {
        background: #2c67cc !important;
        box-shadow: inset 4px 0px 24px 0px rgba(55,58,65,1), 0 0 12px rgba(102,124,162,0.42), inset 0 4px 4px rgba(102,124,162,1) !important;
        border-color: #667ca2 !important;
      }
    `;
    document.head.appendChild(style);



    // Map elements
    const heatButtons = [];
    const coolingEl = document.querySelector('.manual-cooling');
    for (let i = 1; i <= 8; i++) {
      const el = document.querySelector(`.manual-tip-heat-${i}`);
      if (el) heatButtons[i] = el;
    }
    const upEl = document.querySelector('.manual-platen-up');
    const downEl = document.querySelector('.manual-platen-down');

    // Momentary press handlers
    function bindMomentary(el, onPress, onRelease) {
      if (!el) return;
      const press = (e) => { e.preventDefault(); el.classList.add('pressed-blue'); onPress(); };
      const release = (e) => { e && e.preventDefault(); el.classList.remove('pressed-blue'); onRelease(); };
      el.addEventListener('mousedown', press);
      el.addEventListener('mouseup', release);
      el.addEventListener('mouseleave', () => release());
      el.addEventListener('touchstart', press, { passive: false });
      el.addEventListener('touchend', release, { passive: false });
      el.addEventListener('contextmenu', (e) => e.preventDefault());
      return release;
    }





    bindMomentary(upEl,
      () => { /* Button press handler removed */ },
      () => { /* Button release handler removed */ }
    );
    bindMomentary(downEl,
      () => { /* Button press handler removed */ },
      () => { /* Button release handler removed */ }
    );

    // Heating 1..8 are momentary (hold while pressed)
    const heatState = Array(9).fill(false);

    function pressHeat(i) {
      if (heatState[i]) return;
      heatState[i] = true;
      if (heatButtons[i]) heatButtons[i].classList.add('pressed-blue');
      // Heat button communication removed
    }
    function releaseHeat(i) {
      if (!heatState[i]) return;
      heatState[i] = false;
      if (heatButtons[i]) heatButtons[i].classList.remove('pressed-blue');
      // Heat button communication removed
    }
    for (let i = 1; i <= 8; i++) {
      const el = heatButtons[i];
      if (!el) continue;
      // Mouse
      el.addEventListener('mousedown', (e) => { e.preventDefault(); pressHeat(i); });
      el.addEventListener('mouseup', () => releaseHeat(i));
      el.addEventListener('mouseleave', () => releaseHeat(i));
      // Touch
      el.addEventListener('touchstart', (e) => { e.preventDefault(); pressHeat(i); }, { passive: false });
      el.addEventListener('touchend', () => releaseHeat(i));
      // Context menu prevention
      el.addEventListener('contextmenu', (e) => e.preventDefault());
    }

    // Cooling is also momentary
    let coolingOn = false;

    if (coolingEl) {
      const coolingPress = (e) => {
        e.preventDefault();
        if (coolingOn) return;
        coolingOn = true;
        coolingEl.classList.add('pressed-blue');
        // Cooling button communication removed
      };
      const coolingRelease = (e) => {
        if (e) e.preventDefault();
        if (!coolingOn) return;
        coolingOn = false;
        coolingEl.classList.remove('pressed-blue');
        // Cooling button communication removed
      };
      // Mouse
      coolingEl.addEventListener('mousedown', coolingPress);
      coolingEl.addEventListener('mouseup', coolingRelease);
      coolingEl.addEventListener('mouseleave', coolingRelease);
      // Touch
      coolingEl.addEventListener('touchstart', coolingPress, { passive: false });
      coolingEl.addEventListener('touchend', coolingRelease, { passive: false });
      coolingEl.addEventListener('contextmenu', (e) => e.preventDefault());
    }

    // No global periodic re-announce for toggles; only while pressed

    // Receive periodic state snapshot from backend and render
    window.addEventListener('manual-controls-update', (e) => {
      const p = (e.detail && e.detail.payload) || {};
      if (p.platen_mm !== undefined) {
        const txt = document.querySelector('.manual-platen-distance');
        if (txt) txt.textContent = `${(+p.platen_mm).toFixed(1)} mm`;
      }
      // Do NOT overwrite button states from backend; UI is source of truth
      // Show blue for up/down while pressed
      if (typeof p.up_pressed === 'boolean' && upEl) upEl.classList.toggle('pressed-blue', p.up_pressed);
      if (typeof p.down_pressed === 'boolean' && downEl) downEl.classList.toggle('pressed-blue', p.down_pressed);
    });
  </script>
</body>
</html>